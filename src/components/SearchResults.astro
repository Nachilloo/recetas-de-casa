---
import RecetaCardCompact from './RecetaCardCompact.astro';
import { categorias } from '../content/config';

export interface Props {
  recetas: any[];
  termino: string;
  categoria?: string;
  totalRecetas: number;
}

const { recetas, termino, categoria, totalRecetas } = Astro.props;

const getCategoriaEmoji = (cat: string) => {
  const iconos: { [key: string]: string } = {
    'arroz-paellas': 'ğŸ¥˜',
    'tortillas-pasta': 'ğŸ¥š',
    'sopas-cremas': 'ğŸ²',
    'carnes-aves': 'ğŸ–',
    'pescados-mariscos': 'ğŸŸ',
    'pan-masas': 'ğŸ¥–',
    'postres': 'ğŸ°',
    'tapas-aperitivos': 'ğŸ¤'
  };
  return iconos[cat] || 'ğŸ½ï¸';
};
---

<div class="search-results">
  <!-- InformaciÃ³n de resultados -->
  <div class="mb-6">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-2xl font-bold text-gray-900">
        {termino ? `ğŸ” Resultados para "${termino}"` : 'ï¸ Todas las Recetas'}
        {categoria && (
          <span class="text-lg font-normal text-gray-600 ml-2">
            en {categorias[categoria]}
          </span>
        )}
      </h2>
      <span class="text-sm text-gray-500">
        {totalRecetas} receta{totalRecetas !== 1 ? 's' : ''} encontrada{totalRecetas !== 1 ? 's' : ''}
      </span>
    </div>

    <!-- Filtros activos -->
    {(termino || categoria) && (
      <div class="flex flex-wrap items-center gap-2 mb-4">
        <span class="text-sm text-gray-600">Filtros activos:</span>
        
        {categoria && (
          <div class="flex items-center bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm">
            <span class="mr-1">{getCategoriaEmoji(categoria)}</span>
            <span>{categorias[categoria]}</span>
            <a href={`/buscar${termino ? `?q=${encodeURIComponent(termino)}` : ''}`} class="ml-2 hover:text-orange-600">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </a>
          </div>
        )}
        
        {termino && (
          <div class="flex items-center bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
            <span>"{termino}"</span>
            <a href={`/buscar${categoria ? `?categoria=${categoria}` : ''}`} class="ml-2 hover:text-blue-600">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </a>
          </div>
        )}
        
        <a href="/buscar" class="text-sm text-gray-500 hover:text-gray-700 underline">
          Limpiar todos
        </a>
      </div>
    )}
  </div>

  <!-- Lista de resultados -->
  {totalRecetas === 0 ? (
    <div class="text-center py-12">
      <div class="text-6xl mb-4">ğŸ”</div>
      <h3 class="text-xl font-semibold text-gray-700 mb-2">No se encontraron recetas</h3>
      <p class="text-gray-500 mb-6">
        {termino 
          ? `No hay recetas que coincidan con "${termino}"`
          : categoria 
            ? `No hay recetas en la categorÃ­a ${categorias[categoria]}`
            : 'No hay recetas disponibles'
        }
      </p>
      <div class="space-x-4">
        <a href="/buscar" class="inline-block bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200">
          Ver todas las recetas
        </a>
        <a href="/" class="inline-block bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-medium transition-colors duration-200">
          Volver al inicio
        </a>
      </div>
    </div>
  ) : (
    <div class="grid gap-4">
      {recetas.map(receta => (
        <RecetaCardCompact receta={receta} />
      ))}
    </div>
  )}
</div>